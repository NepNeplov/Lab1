% --- Дані ---
% Клас 0: жокеї (низький зріст і вага)
P_white = [160 165 155 170 168 163 150 158 162 169;
           55  60  50  65  63  61  52  58  60  64];

% Клас 1: баскетболісти (високий зріст і вага)
P_black = [175 180 185 190 178 182 176 188 192 179;
           70  75  80  85  73  78  72  83  87  76];

% Об'єднання даних
P = [P_white P_black]; % Вхідні вектори (2x20)
T = [zeros(1, size(P_white,2)), ones(1, size(P_black,2))]; % Мітки класів (1x20)

% --- Створення та навчання персептрона ---
net = perceptron;
net.trainParam.showWindow = false; % Без вікна тренування
net.trainParam.epochs = 100;
net = train(net, P, T);

% --- Отримання параметрів ---
w = net.IW{1}; % ваги
b = net.b{1};  % зсув

% --- Побудова графіка ---
figure;
gscatter(P(1,:), P(2,:), T, 'kr', 'ox', 8); % 'k' — чорний (баскетболісти), 'r' — червоний (жокеї)
xlabel('Зріст (см)');
ylabel('Вага (кг)');
title('Класифікація атлетів персептроном');
legend('Клас 0 (жокеї)', 'Клас 1 (баскетболісти)', 'Location', 'northwest');
grid on;
hold on;

% --- Розділяюча пряма ---
x_vals = linspace(min(P(1,:)) - 5, max(P(1,:)) + 5, 100);
y_vals = -(w(1)/w(2))*x_vals - b/w(2);
plot(x_vals, y_vals, 'b-', 'LineWidth', 2);
