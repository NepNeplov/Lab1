% Дані: P - [зріст; вага], T - класи
P = [160 165 170 175 180 185 190 195 200 205;
     50  55  60  65  70  75  80  85  90  95];  % приклад даних (2x10)

T = [0 0 0 0 0 1 1 1 1 1];  % 0 - жокеї, 1 - баскетболісти

% Створення персептрона
net = perceptron;
net.trainParam.epochs = 100;
net = train(net, P, T);

% Побудова графіка
figure;

% gscatter потребує вхідні дані по рядках => транспонуємо
gscatter(P(1,:)', P(2,:)', T', 'rb', 'ox', 8);
xlabel('Зріст (см)');
ylabel('Вага (кг)');
title('Класифікація атлетів персептроном');
grid on;
hold on;

% Роздільна лінія
w = net.IW{1};  % ваги
b = net.b{1};   % зсув

x = 150:1:210;  % діапазон значень зросту
y = -(w(1)*x + b)/w(2);  % розрахунок відповідних ваг
plot(x, y, 'k--', 'LineWidth', 2);

legend('Жокеї', 'Баскетболісти', 'Роздільна лінія');
